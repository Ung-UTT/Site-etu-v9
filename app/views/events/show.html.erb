<%= title 'Événement : ' + @event.title %>

<p>
  <b>Description :</b>
  <%= @event.content %>
</p>

<p>
  <b>Organisateur :</b>
  <%= link_to_user @event.organizer %>
</p>

<p>
  <b>Lieu :</b>
  <%= @event.location %>
</p>

<p>
  <b>Date :</b>
  <%= @event.date.strftime 'le %d %B %Y à %Hh%M' %>
</p>

<p>
  <b>Participants :</b>
  <% @event.users.each do |user| %>
    <%= link_to_user user %>
  <% end %>
</p>

<% if @event.users.exists?(current_user) and can? :disjoin, Event %>
  <%= form_tag(disjoin_event_path(@event), :method => 'PUT') do %>
    <div class="actions">
      <%= submit_tag 'Ne plus participer' %>
    </div>
  <% end %>
<% elsif can? 'join'.to_sym, Event %>
  <%= form_tag(join_event_path(@event), :method => 'PUT') do %>
    <div class="actions">
      <%= submit_tag 'Participer' %>
    </div>
  <% end %>
<% end %>

<% if can? :update, @event %>
  <%= link_to 'Modifier cet événement', edit_event_path(@event) %> |
<% end %>
<% if can? :destroy, @event %>
  <%= link_to 'Supprimer', @event, :confirm => 'Sûr ?', :method => :delete %> |
<% end %>
<%= link_to 'Retourner à la liste des événements', events_path %>

<%= render 'comments/list_and_add', {:commentable => @event, :comments => @comments} %>